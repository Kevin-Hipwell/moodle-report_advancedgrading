define ("report_advancedgrading/sdt/columns",["exports","./helpers"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.Columns=void 0;var l="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{};function c(a){return g(a)||f(a)||e(a)||d()}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function e(a,b){if(!a)return;if("string"==typeof a)return h(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return h(a,b)}function f(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}function g(a){if(Array.isArray(a))return h(a)}function h(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function i(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function j(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function k(a,b,c){if(b)j(a.prototype,b);if(c)j(a,c);return a}var m=function(){function a(b){i(this,a);this.dt=b;return this}k(a,[{key:"swap",value:function swap(a){if(a.length&&2===a.length){var b=[];this.dt.headings.forEach(function(a,c){b.push(c)});var c=a[0],d=a[1],e=b[d];b[d]=b[c];b[c]=e;this.order(b)}}},{key:"order",value:function order(e){var f,g,j,k,i,l,m,n=[[],[],[],[]],o=this.dt;e.forEach(function(a,b){i=o.headings[a];l="false"!==i.getAttribute("data-sortable");f=i.cloneNode(!0);f.originalCellIndex=b;f.sortable=l;n[0].push(f);if(!o.hiddenColumns.includes(a)){g=i.cloneNode(!0);g.originalCellIndex=b;g.sortable=l;n[1].push(g)}});o.data.forEach(function(a,b){j=a.cloneNode(!1);k=a.cloneNode(!1);j.dataIndex=k.dataIndex=b;if(null!==a.searchIndex&&a.searchIndex!==void 0){j.searchIndex=k.searchIndex=a.searchIndex}e.forEach(function(b){m=a.cells[b].cloneNode(!0);m.data=a.cells[b].data;j.appendChild(m);if(!o.hiddenColumns.includes(b)){m=a.cells[b].cloneNode(!0);m.data=a.cells[b].data;k.appendChild(m)}});n[2].push(j);n[3].push(k)});o.headings=n[0];o.activeHeadings=n[1];o.data=n[2];o.activeRows=n[3];o.update()}},{key:"hide",value:function hide(a){if(a.length){var b=this.dt;a.forEach(function(a){if(!b.hiddenColumns.includes(a)){b.hiddenColumns.push(a)}});this.rebuild()}}},{key:"show",value:function show(a){if(a.length){var b,c=this.dt;a.forEach(function(a){b=c.hiddenColumns.indexOf(a);if(-1<b){c.hiddenColumns.splice(b,1)}});this.rebuild()}}},{key:"visible",value:function visible(a){var b,c=this.dt;a=a||c.headings.map(function(a){return a.originalCellIndex});if(!isNaN(a)){b=!c.hiddenColumns.includes(a)}else if(Array.isArray(a)){b=[];a.forEach(function(a){b.push(!c.hiddenColumns.includes(a))})}return b}},{key:"add",value:function add(a){var b=this,c,d=document.createElement("th");if(!this.dt.headings.length){this.dt.insert({headings:[a.heading],data:a.data.map(function(a){return[a]})});this.rebuild();return}if(!this.dt.hiddenHeader){if(a.heading.nodeName){d.appendChild(a.heading)}else{d.innerHTML=a.heading}}else{d.innerHTML=""}this.dt.headings.push(d);this.dt.data.forEach(function(d,e){if(a.data[e]){c=document.createElement("td");if(a.data[e].nodeName){c.appendChild(a.data[e])}else{c.innerHTML=a.data[e]}c.data=c.innerHTML;if(a.render){c.innerHTML=a.render.call(b,c.data,c,d)}d.appendChild(c)}});if(a.type){d.setAttribute("data-type",a.type)}if(a.format){d.setAttribute("data-format",a.format)}if(a.hasOwnProperty("sortable")){d.sortable=a.sortable;d.setAttribute("data-sortable",!0===a.sortable?"true":"false")}this.rebuild();this.dt.renderHeader()}},{key:"remove",value:function remove(a){var b=this;if(Array.isArray(a)){a.sort(function(c,a){return a-c});a.forEach(function(a){return b.remove(a)})}else{this.dt.headings.splice(a,1);this.dt.data.forEach(function(b){b.removeChild(b.cells[a])})}this.rebuild()}},{key:"filter",value:function filter(a,b,d,e){var f=this.dt;if(!f.filterState){f.filterState={originalData:f.data}}if(!f.filterState[a]){var j=[].concat(c(e),[function(){return!0}]);f.filterState[a]=function(){var a=0;return function(){return j[a++%j.length]}}()}var g=f.filterState[a](),h=Array.from(f.filterState.originalData).filter(function(b){var c=b.cells[a],d=c.hasAttribute("data-content")?c.getAttribute("data-content"):c.innerText;return"function"==typeof g?g(d):d===g});f.data=h;if(!f.data.length){f.clear();f.hasRows=!1;f.setMessage(f.options.labels.noRows)}else{this.rebuild();f.update()}if(!d){f.emit("datatable.sort",a,b)}}},{key:"sort",value:function sort(c,d,e){var f=this,g=this.dt;if(g.hasHeadings&&(0>c||c>g.headings.length)){return!1}var h=g.options.filters&&g.options.filters[g.headings[c].textContent];if(h&&0!==h.length){this.filter(c,d,e,h);return}g.sorting=!0;if(!e){g.emit("datatable.sorting",c,d)}var i=g.data,j=[],k=[],m=0,o=0,p=g.headings[c],q=[];if("date"===p.getAttribute("data-type")){var r=!1,s=p.hasAttribute("data-format");if(s){r=p.getAttribute("data-format")}q.push(("function"==typeof l.define&&l.define.amd?new Promise(function(a,b){l.require(["./date"],a,b)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&l.require&&"component"===l.require.loader?Promise.resolve(require(("./date"))):Promise.resolve(l["./date"])).then(function(a){var b=a.parseDate;return function(a){return b(a,r)}}))}Promise.all(q).then(function(a){var h=a[0];Array.from(i).forEach(function(a){var b=a.cells[c],d=b.hasAttribute("data-content")?b.getAttribute("data-content"):b.innerText,e;if(h){e=h(d)}else if("string"==typeof d){e=d.replace(/(\$|,|\s|%)/g,"")}else{e=d}if(parseFloat(e)==e){k[o++]={value:+e,row:a}}else{j[m++]={value:"string"==typeof d?d.toLowerCase():d,row:a}}});if(!d){if(p.classList.contains("asc")){d="desc"}else{d="asc"}}var l,n;if("desc"==d){l=(0,b.sortItems)(j,-1);n=(0,b.sortItems)(k,-1);p.classList.remove("asc");p.classList.add("desc")}else{l=(0,b.sortItems)(k,1);n=(0,b.sortItems)(j,1);p.classList.remove("desc");p.classList.add("asc")}if(g.lastTh&&p!=g.lastTh){g.lastTh.classList.remove("desc");g.lastTh.classList.remove("asc")}g.lastTh=p;i=l.concat(n);g.data=[];var q=[];i.forEach(function(a,b){g.data.push(a.row);if(null!==a.row.searchIndex&&a.row.searchIndex!==void 0){q.push(b)}});g.searchData=q;f.rebuild();g.update();if(!e){g.emit("datatable.sort",c,d)}})}},{key:"rebuild",value:function rebuild(){var e,f,g,h,j=this.dt,k=[];j.activeRows=[];j.activeHeadings=[];j.headings.forEach(function(a,b){a.originalCellIndex=b;a.sortable="false"!==a.getAttribute("data-sortable");if(!j.hiddenColumns.includes(b)){j.activeHeadings.push(a)}});j.data.forEach(function(a,b){e=a.cloneNode(!1);f=a.cloneNode(!1);e.dataIndex=f.dataIndex=b;if(null!==a.searchIndex&&a.searchIndex!==void 0){e.searchIndex=f.searchIndex=a.searchIndex}Array.from(a.cells).forEach(function(a){g=a.cloneNode(!0);g.data=a.data;e.appendChild(g);if(!j.hiddenColumns.includes(g.cellIndex)){h=g.cloneNode(!0);h.data=g.data;f.appendChild(h)}});k.push(e);j.activeRows.push(f)});j.data=k;j.update()}}]);return a}();a.Columns=m});
//# sourceMappingURL=columns.min.js.map
